(function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};define(function(require){var t,n;return t=require("./base"),n=function(t){function n(t,e,i,r,s){this.$element=t,this.scope=e,this.parent=i,this.root=r,this.childParser=s,this.binding=this.$element.data("for"),this.parts=this.binding.split("in"),this.itemName=$.trim(this.parts[0]),this.collectionName=$.trim(this.parts[1]),this.getTemplate(),this.parseItems(),n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.getTemplate=function(){return this.$template=this.$element.contents().remove()},n.prototype.getCollection=function(){var t;return t=this.parseBinding(this.collectionName),(("function"==typeof t?t():void 0)||t).slice(0)},n.prototype.parseItems=function(t){var e,n,i,r,s,o,a,p;for(this.collection=null!=t?t:this.getCollection(t),a=this.collection,p=[],n=s=0,o=a.length;o>s;n=++s)i=a[n],e=this.$template.clone().appendTo(this.$element),r=$.extend({},this.scope),"object"==typeof i?(r[this.itemName]=$.extend({},i),r[this.itemName].$index=n,r[this.itemName].$total=this.collection.length):r[this.itemName]=i,p.push(this.childParser(e,r,this.parent,this.root));return p},n.prototype.updateItems=function(){var t;return t=this.getCollection(),this.collection!==t&&JSON.stringify(this.collection)!==JSON.stringify(t)?(this.logic&&this.wrap(),this.$element.empty(),this.parseItems(t),this.logic?this.unwrap():void 0):void 0},n.prototype.update=function(){return this.updateItems()},n}(t)})}).call(this);