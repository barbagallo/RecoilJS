/*! BoringJS (Alpha) by Robert Messerle  |  https://github.com/robertmesserle/BoringJS */
/*! This work is licensed under the Creative Commons Attribution 3.0 Unported License. To view a copy of this license, visit http://creativecommons.org/licenses/by/3.0/. */

(function($){(function(){return $.fn.makeBoring=function(controller){var $element;if(globals.app)throw"You may only have one app running at a time.";return $element=$(this),globals.app=new Core($element,controller)},$.makeBoring=function(id,controller){if(globals.app)throw"You may only have one app running at a time.";return $(function(){return $("[data-app='"+id+"']:first").makeBoring(controller)})},$.boring={createTransition:function(type,id,callback){return globals.transitions[type][id]=callback}}})();var globals;globals={app:null,bindings:[],views:{},transitions:{intro:{},outro:{}},events:"blur focus focusin focusout load resize scroll unload click\ndblclick mousedown mouseup mousemove mouseover mouseout mouseenter\nmouseleave change select submit keydown keypress keyup error".split(/\s+/g),attributes:"class id src href style".split(/\s+/g)},function(){var elementList;return elementList="undefined"!=typeof InstallTrigger?[HTMLAnchorElement,HTMLAppletElement,HTMLAreaElement,HTMLAudioElement,HTMLBaseElement,HTMLBodyElement,HTMLBRElement,HTMLButtonElement,HTMLCanvasElement,HTMLDataListElement,HTMLDirectoryElement,HTMLDivElement,HTMLDListElement,HTMLElement,HTMLEmbedElement,HTMLFieldSetElement,HTMLFontElement,HTMLFormElement,HTMLFrameElement,HTMLFrameSetElement,HTMLHeadElement,HTMLHeadingElement,HTMLHtmlElement,HTMLHRElement,HTMLIFrameElement,HTMLImageElement,HTMLInputElement,HTMLLabelElement,HTMLLegendElement,HTMLLIElement,HTMLLinkElement,HTMLMapElement,HTMLMediaElement,HTMLMenuElement,HTMLMetaElement,HTMLMeterElement,HTMLModElement,HTMLObjectElement,HTMLOListElement,HTMLOptGroupElement,HTMLOptionElement,HTMLOutputElement,HTMLParagraphElement,HTMLParamElement,HTMLPreElement,HTMLProgressElement,HTMLQuoteElement,HTMLScriptElement,HTMLSelectElement,HTMLSourceElement,HTMLSpanElement,HTMLStyleElement,HTMLTableElement,HTMLTableCaptionElement,HTMLTableColElement,HTMLTableRowElement,HTMLTableSectionElement,HTMLTextAreaElement,HTMLTitleElement,HTMLUListElement,HTMLUnknownElement,HTMLVideoElement]:[Element],function(){var originalMethod,type,_i,_len;for(_i=0,_len=elementList.length;_len>_i;_i++){if(type=elementList[_i],type.prototype.addEventListener){if(originalMethod=type.prototype.addEventListener,!originalMethod)return;type.prototype.addEventListener=function(type,listener){var args;return args=Array.apply(null,arguments),args[1]=function(){var _ref;return listener.apply(null,arguments),null!=(_ref=globals.app)?_ref.checkForChanges():void 0},originalMethod.apply(this,args)}}if(type.prototype.attachEvent){if(originalMethod=type.prototype.attachEvent,!originalMethod)return;type.prototype.attachEvent=function(type,listener){var args;return args=Array.apply(null,arguments),args[1]=function(){var _ref;return listener.apply(null,arguments),null!=(_ref=globals.app)?_ref.checkForChanges():void 0},originalMethod.apply(this,args)}}}}(),$(function(){return $(document).ajaxComplete(function(){var _ref;return null!=(_ref=globals.app)?_ref.checkForChanges():void 0})})}();var Base;Base=function(){function Base($element){this.$element=$element,this.logic=this.$element.data("logic"),this.logic&&(this.insertPlaceholder(),this.unwrap()),this.update&&this.pushBinding()}return Base.prototype.pushBinding=function(){return globals.bindings.push(this)},Base.prototype.parseBinding=function(binding){var jsBinding,_ref;return null==(_ref=this.cachedBindings)&&(this.cachedBindings={}),(jsBinding=this.cachedBindings[binding])?jsBinding.call(this):(this.cachedBindings[binding]=this.generateFunction(binding),this.cachedBindings[binding].call(this))},Base.prototype.parseString=function(str){var jsString,_ref;return null==(_ref=this.cachedStrings)&&(this.cachedStrings={}),(jsString=this.cachedStrings[str])?jsString.call(this):(str=str.replace(/\"/g,'\\"'),str='"'+str+'"',this.cachedStrings[str]=this.generateFunction(str),this.cachedStrings[str].call(this))},Base.prototype.generateFunction=function(str){var args,js,key,scopeArgs;js=CoffeeScript.compile("do -> "+str,{bare:!0}),args=[],scopeArgs=[];for(key in this.scope)isNaN(key)&&(args.push(key),scopeArgs.push("this.scope."+key));return args.push("$element, $root, $parent, $data, window, document, $"),scopeArgs.push("this.$element, this.root, this.parent, this.scope"),eval("( function () {\n  return ( function ( "+args.join(",")+" ) {\n    return "+js+"\n  } ).call( {}, "+scopeArgs.join(", ")+" )\n} )")},Base.prototype.updateBinding=function(value,binding){var part,parts,scope;return null==binding&&(binding=this.binding),parts=binding.split("."),part=parts.pop(),scope=this.parseBinding(parts.join("."))||this.scope,("function"==typeof scope[part]?scope[part](value):void 0)||(scope[part]=value)},Base.prototype.insertPlaceholder=function(){var attr,str;return str=function(){var _i,_len,_ref,_results;for(_ref=this.$element.get(0).attributes,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)attr=_ref[_i],_results.push(""+attr.nodeName+"='"+attr.value+"'");return _results}.call(this).join(" "),this.$placeholder=$("<!-- Start BoringJS Block: "+str+" -->").insertBefore(this.$element),$("<!-- End BoringJS Block: "+str+" -->").insertAfter(this.$element)},Base.prototype.wrap=function(){return this.unwrapped?(this.unwrapped=!1,this.$contents.eq(0).before(this.$element),this.$element.append(this.$contents)):void 0},Base.prototype.unwrap=function(){return this.unwrapped||(this.unwrapped=!0),this.$contents=this.$element.contents().insertAfter(this.$element),this.$element.detach()},Base}();var AttributeText,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};AttributeText=function(_super){function AttributeText(attribute,$element,scope,parent,root){this.attribute=attribute,this.$element=$element,this.scope=scope,this.parent=parent,this.root=root,this.template=this.attribute.nodeValue,this.attribute.nodeName.match(/^data/)||this.template.match("{")&&(this.updateValue(),this.pushBinding())}return __extends(AttributeText,_super),AttributeText.prototype.updateValue=function(){var value;return value=this.parseString(this.template),this.value!==value?(this.value=value,this.attribute.nodeValue=value):void 0},AttributeText.prototype.update=function(){return this.updateValue()},AttributeText}(Base);var AttributeBinding,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};AttributeBinding=function(_super){function AttributeBinding(attribute,$element,scope,parent,root){this.attribute=attribute,this.$element=$element,this.scope=scope,this.parent=parent,this.root=root,this.binding=this.$element.data(this.attribute),this.setValue(),this.pushBinding()}return __extends(AttributeBinding,_super),AttributeBinding.prototype.setValue=function(){var value;return value=this.parseBinding(this.binding),this.value!==value?(this.value=value,this.$element.attr(this.attribute,this.value)):void 0},AttributeBinding.prototype.update=function(){return this.setValue()},AttributeBinding}(Base);var ComposeBinding,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};ComposeBinding=function(_super){function ComposeBinding($element,scope,parent,root,childParser){var _ref;this.$element=$element,this.scope=scope,this.parent=parent,this.root=null!=root?root:this.scope,this.childParser=childParser,this.renderView=__bind(this.renderView,this),this.binding=this.$element.data("compose"),this.controller=this.parseBinding(this.binding),this.view=null!=(_ref=this.controller)?_ref.view:void 0,this.loadView(),this.pushBinding()}return __extends(ComposeBinding,_super),ComposeBinding.prototype.loadView=function(){var url,_this=this;return url="/views/"+this.view+".html",globals.views[url]?this.renderView(globals.views[url]):$.ajax({url:url,success:function(data){return data=globals.views[url]=data.replace(/<\$/g,'<div data-logic="true"').replace(/<\/\$>/g,"</div>"),_this.renderView(data)}})},ComposeBinding.prototype.renderView=function(data){var intro,_base,_ref;return null==data&&(data=this.html),this.html=data,this.$element.html(this.html),this.childParser(this.$element.children(),this.controller,this.scope,this.root),"function"==typeof(_base=this.controller).afterRender&&_base.afterRender({$dom:this.$element,scope:this.scope,parent:this.parent,root:this.root}),intro=globals.transitions.intro[this.view]||(null!=(_ref=this.controller)?_ref.intro:void 0)||null,"function"==typeof intro?intro(this.$element):void 0},ComposeBinding.prototype.update=function(){var callback,controller,outro,_ref,_this=this;return controller=this.parseBinding(this.binding),this.controller!==controller?(callback=function(){return _this.controller=controller,_this.view=_this.controller.view,_this.loadView()},outro=globals.transitions.outro[this.view]||(null!=(_ref=this.controller)?_ref.outro:void 0)||null,("function"==typeof outro?outro(this.$element,callback):void 0)||callback()):void 0},ComposeBinding}(Base);var CSSBinding,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};CSSBinding=function(_super){function CSSBinding($element,scope,parent,root){this.$element=$element,this.scope=scope,this.parent=parent,this.root=root,this.binding=this.$element.data("css"),this.css=this.parseBinding(this.binding),this.$element.css(this.css)}return __extends(CSSBinding,_super),CSSBinding}(Base);var EachBinding,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};EachBinding=function(_super){function EachBinding($element,scope,parent,root,childParser){this.$element=$element,this.scope=scope,this.parent=parent,this.root=root,this.childParser=childParser,this.binding=this.$element.data("each"),this.getTemplate(),this.parseItems(),EachBinding.__super__.constructor.apply(this,arguments)}return __extends(EachBinding,_super),EachBinding.prototype.getTemplate=function(){return this.$template=this.$element.contents().remove()},EachBinding.prototype.getItems=function(){var items;return items=this.parseBinding(this.binding),(("function"==typeof items?items():void 0)||items).slice(0)},EachBinding.prototype.parseItems=function(items){var $item,index,item,scope,_i,_len,_ref,_results;for(this.items=null!=items?items:this.getItems(),_ref=this.items,_results=[],index=_i=0,_len=_ref.length;_len>_i;index=++_i)item=_ref[index],$item=this.$template.clone().appendTo(this.$element),scope=$.extend({},this.scope),scope.$index=index,scope.$total=this.items.length,_results.push(this.childParser($item,item,this.scope,this.root));return _results},EachBinding.prototype.updateItems=function(){var items;return items=this.getItems(),this.items!==items&&JSON.stringify(this.items)!==JSON.stringify(items)?(this.logic&&this.wrap(),this.$element.empty(),this.parseItems(items),this.logic?this.unwrap():void 0):void 0},EachBinding.prototype.update=function(){return this.updateItems()},EachBinding}(Base);var EventBinding,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};EventBinding=function(_super){function EventBinding(eventName,$element,scope,parent,root){var csString,func,str,_this=this;this.$element=$element,this.scope=scope,this.parent=parent,this.root=root,str=$element.data(eventName),csString="-> "+str,func=this.parseBinding(csString),eventName=""+eventName+".boringjs",$element.off(eventName).on(eventName,function(event){return func.call(_this,event)})}return __extends(EventBinding,_super),EventBinding.prototype.generateFunction=function(str){var args,js,key,scopeArgs;js=CoffeeScript.compile("do -> "+str,{bare:!0}),args=[],scopeArgs=[];for(key in this.scope)isNaN(key)&&(args.push(key),scopeArgs.push("this.scope."+key));return args.push("$element, $root, $parent, $data, window, document, $"),scopeArgs.push("this.$element, this.root, this.parent, this.scope"),eval("( function ( event, $element, scope, parent, root ) {\n  return ( function ( "+args.join(",")+" ) {\n    return "+js+"\n  } ).call( {}, "+scopeArgs.join(", ")+" )\n} )")},EventBinding}(Base);var ForBinding,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};ForBinding=function(_super){function ForBinding($element,scope,parent,root,childParser){this.$element=$element,this.scope=scope,this.parent=parent,this.root=root,this.childParser=childParser,this.binding=this.$element.data("for"),this.parts=this.binding.split("in"),this.itemName=$.trim(this.parts[0]),this.collectionName=$.trim(this.parts[1]),this.getTemplate(),this.parseItems(),ForBinding.__super__.constructor.apply(this,arguments)}return __extends(ForBinding,_super),ForBinding.prototype.getTemplate=function(){return this.$template=this.$element.contents().remove()},ForBinding.prototype.getCollection=function(){var items;return items=this.parseBinding(this.collectionName),(("function"==typeof items?items():void 0)||items).slice(0)},ForBinding.prototype.parseItems=function(collection){var $item,index,item,scope,_i,_len,_ref,_results;for(this.collection=null!=collection?collection:this.getCollection(collection),_ref=this.collection,_results=[],index=_i=0,_len=_ref.length;_len>_i;index=++_i)item=_ref[index],$item=this.$template.clone().appendTo(this.$element),scope=$.extend({},this.scope),"object"==typeof item?(scope[this.itemName]=$.extend({},item),scope[this.itemName].$index=index,scope[this.itemName].$total=this.collection.length):scope[this.itemName]=item,_results.push(this.childParser($item,scope,this.parent,this.root));return _results},ForBinding.prototype.updateItems=function(){var collection;return collection=this.getCollection(),this.collection!==collection&&JSON.stringify(this.collection)!==JSON.stringify(collection)?(this.logic&&this.wrap(),this.$element.empty(),this.parseItems(collection),this.logic?this.unwrap():void 0):void 0},ForBinding.prototype.update=function(){return this.updateItems()},ForBinding}(Base);var HTMLBinding,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};HTMLBinding=function(_super){function HTMLBinding($element,scope,parent,root){this.$element=$element,this.scope=scope,this.parent=parent,this.root=root,this.binding=this.$element.data("html"),this.setValue(),this.pushBinding()}return __extends(HTMLBinding,_super),HTMLBinding.prototype.setValue=function(){var value;return value=this.parseBinding(this.binding),this.value!==value?(this.value=value,this.$element.html(this.value)):void 0},HTMLBinding.prototype.update=function(){return this.setValue()},HTMLBinding}(Base);var IfBinding,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};IfBinding=function(_super){function IfBinding($element,scope,parent,root,callback){this.$element=$element,this.scope=scope,this.parent=parent,this.root=root,this.callback=callback,this.binding=this.$element.data("if"),this.insertPlaceholder(),this.setValue(),this.pushBinding()}return __extends(IfBinding,_super),IfBinding.prototype.setValue=function(){var value;return value=this.parseBinding(this.binding),this.value!==value?(this.value=value,this.value?(this.$element.insertAfter(this.$placeholder),this.unwrap()):(this.wrap(),this.$element.detach())):void 0},IfBinding.prototype.update=function(){return this.setValue()},IfBinding}(Base);var TextNode,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};TextNode=function(_super){function TextNode($element,scope,parent,root){this.$element=$element,this.scope=scope,this.parent=parent,this.root=root,this.template=this.$element.text(),this.template.indexOf("{")+1&&(this.element=this.$element.get(0),this.updateValue(),this.pushBinding())}return __extends(TextNode,_super),TextNode.prototype.updateValue=function(){var value;return value=this.parseString(this.template),this.value!==value?this.element.nodeValue=this.value=value:void 0},TextNode.prototype.update=function(){return this.updateValue()},TextNode}(Base);var TextBinding,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};TextBinding=function(_super){function TextBinding($element,scope,parent,root){this.$element=$element,this.scope=scope,this.parent=parent,this.root=root,this.binding=this.$element.data("text"),this.setValue(),this.pushBinding()}return __extends(TextBinding,_super),TextBinding.prototype.setValue=function(){var value;return value=this.parseBinding(this.binding),this.value!==value?(this.value=value,this.$element.text(this.value)):void 0},TextBinding.prototype.update=function(){return this.setValue()},TextBinding}(Base);var UnlessBinding,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};UnlessBinding=function(_super){function UnlessBinding($element,scope,parent,root,callback){this.$element=$element,this.scope=scope,this.parent=parent,this.root=root,this.callback=callback,this.binding=this.$element.data("if"),this.insertPlaceholder(),this.setValue(),this.pushBinding()}return __extends(UnlessBinding,_super),UnlessBinding.prototype.setValue=function(){var value;return value=!this.parseBinding(this.binding),this.value!==value?(this.value=value,this.value?(this.$element.insertAfter(this.$placeholder),this.unwrap()):(this.wrap(),this.$element.detach())):void 0},UnlessBinding.prototype.update=function(){return this.setValue()},UnlessBinding}(Base);var UpdateBinding,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};UpdateBinding=function(_super){function UpdateBinding($element,scope,parent,root){var binding,csString;this.$element=$element,this.scope=scope,this.parent=parent,this.root=root,binding=this.$element.data("update"),csString="-> "+binding,this.func=this.parseBinding(csString),this.func(),this.pushBinding()}return __extends(UpdateBinding,_super),UpdateBinding.prototype.update=function(){return this.func()},UpdateBinding}(Base);var ValueBinding,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};ValueBinding=function(_super){function ValueBinding($element,scope,parent,root){this.$element=$element,this.scope=scope,this.parent=parent,this.root=root,this.updateHandler=__bind(this.updateHandler,this),this.binding=this.$element.data("value"),this.setValue(),this.bindEvents(),this.pushBinding(),this.$element.is("select")&&this.$element.trigger(this.getDefaultEvents())}return __extends(ValueBinding,_super),ValueBinding.prototype.getValue=function(){var value;if("radio"!==this.$element.attr("type")||this.$element.is(":checked"))return value=this.parseBinding(this.binding),value=("function"==typeof value?value():void 0)||value},ValueBinding.prototype.setValue=function(){var value;return value=this.getValue(),this.value===value||(this.value=value,this.$element.is("input:radio"))?void 0:this.$element.val(this.value)},ValueBinding.prototype.getDefaultEvents=function(){switch(this.$element.get(0).nodeName.toLowerCase()){case"input":switch(this.$element.attr("type")){case"checkbox":case"radio":return"change";default:return"keydown"}break;case"select":return"change";default:return"blur"}},ValueBinding.prototype.bindEvents=function(){var event;return event=this.$element.data("update-on")||this.getDefaultEvents(),this.$element.on(event,this.updateHandler)},ValueBinding.prototype.updateHandler=function(){var _this=this;return setTimeout(function(){var newValue;if(!_this.$element.is(":radio")||_this.$element.is(":checked"))return newValue=function(){switch(this.$element.attr("type")){case"checkbox":return this.$element.prop("checked");default:return this.$element.val()}}.call(_this),_this.updateBinding(newValue)})},ValueBinding.prototype.update=function(){return this.$element.is(":focus")?void 0:this.setValue()},ValueBinding}(Base);var Parser;Parser=function(){function Parser($dom,scope,parent,root){var _this=this;this.scope=scope,this.parent=parent,this.root=root,$dom.each(function(index,element){var $element;return $element=$(element),_this.parseNode($element)})}return Parser.prototype.parseNode=function($element){var parseChildren,_this=this;return parseChildren=!0,this.attachEvents($element),this.parseAttributes($element),3===$element.get(0).nodeType?(new TextNode($element,this.scope,this.parent,this.root),void 0):($element.data("css")&&new CSSBinding($element,this.scope,this.parent,this.root),null!=$element.data("if")&&(parseChildren=!1,new IfBinding($element,this.scope,this.parent,this.root,function($element){return new Parser($element,_this.scope,_this.parent,_this.root)})),null!=$element.data("unless")&&(parseChildren=!1,new UnlessBinding($element,this.scope,this.parent,this.root,function($element){return new Parser($element,_this.scope,_this.parent,_this.root)})),$element.data("compose")&&(parseChildren=!1,new ComposeBinding($element,this.scope,this.parent,this.root,function($element,scope,parent,root){return new Parser($element,scope,parent,root)})),$element.data("for")&&(parseChildren=!1,new ForBinding($element,this.scope,this.parent,this.root,function($element,scope,parent,root){return new Parser($element,scope,parent,root)})),$element.data("each")&&(parseChildren=!1,new EachBinding($element,this.scope,this.parent,this.root,function($element,scope,parent,root){return new Parser($element,scope,parent,root)})),$element.data("text")&&(parseChildren=!1,new TextBinding($element,this.scope,this.parent,this.root)),$element.data("html")&&new HTMLBinding($element,this.scope,this.parent,this.root),$element.data("value")&&(parseChildren=!1,new ValueBinding($element,this.scope,this.parent,this.root)),$element.data("update")&&new UpdateBinding($element,this.scope,this.parent,this.root),parseChildren?$element.contents().each(function(index,element){return $element=$(element),_this.parseNode($element)}):void 0)},Parser.prototype.parseAttributes=function($element){var attribute,str,_i,_j,_len,_len1,_ref,_ref1,_results;for(_ref=globals.attributes,_i=0,_len=_ref.length;_len>_i;_i++)attribute=_ref[_i],str=$element.data(attribute),str&&new AttributeBinding(attribute,$element,this.scope,this.parent,this.root);for(_ref1=$element.get(0).attributes||[],_results=[],_j=0,_len1=_ref1.length;_len1>_j;_j++)attribute=_ref1[_j],_results.push(new AttributeText(attribute,$element,this.scope,this.parent,this.root));return _results},Parser.prototype.attachEvents=function($element){var event,str,_i,_len,_ref,_results;for(_ref=globals.events,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)event=_ref[_i],str=$element.data(event),str&&_results.push(new EventBinding(event,$element,this.scope,this.parent,this.root));return _results},Parser.prototype.parseString=function(str){var part,parts,scope,value,_i,_len;switch(parts=str.split("."),parts[0]){case"$root":scope=this.root,parts.shift();break;case"$parent":scope=this.parent,parts.shift();break;case"$data":scope=this.scope,parts.shift();break;default:scope=this.scope}for(value=scope,_i=0,_len=parts.length;_len>_i;_i++)part=parts[_i],value=value[part];return value},Parser}();var Core,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};Core=function(){function Core($element,controller){this.$element=$element,this.controller=controller,this.afterRender=__bind(this.afterRender,this),this.controller.view&&this.$element.data("compose","controller"),this.afterRender()}return Core.prototype.afterRender=function(){return new Parser(this.$element,this.controller,!1,this.controller)},Core.prototype.checkForChanges=function(){var _this=this;return setTimeout(function(){var binding,_i,_len,_ref;for(_ref=globals.bindings,_i=0,_len=_ref.length;_len>_i;_i++)binding=_ref[_i],binding.update();return _this.cleanBindings()})},Core.prototype.cleanBindings=function(){var binding,count,element,index,_i,_ref,_results;for(count=globals.bindings.length,_results=[],index=_i=_ref=count-1;0>=_ref?0>=_i:_i>=0;index=0>=_ref?++_i:--_i)binding=globals.bindings[index],element=binding.element||binding.$element.get(0),$.contains(document.body,element)?_results.push(void 0):_results.push(globals.bindings.splice(index,1));return _results},Core}()})(jQuery);