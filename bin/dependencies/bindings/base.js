(function(){define(function(require){var Base,globals;return globals=require("../globals"),Base=function(){function Base(t){this.$element=t,this.logic=this.$element.data("logic"),this.logic&&(this.insertPlaceholder(),this.unwrap()),this.update&&this.pushBinding()}return Base.prototype.pushBinding=function(){return globals.bindings.push(this)},Base.prototype.parseBinding=function(binding){var args,jsBinding,key,scopeArgs,smartFunction,_ref;if(null==(_ref=this.cachedBindings)&&(this.cachedBindings={}),jsBinding=this.cachedBindings[binding])return eval(jsBinding);jsBinding=CoffeeScript.compile("do -> "+binding,{bare:!0}),args=[],scopeArgs=[];for(key in this.scope)isNaN(key)&&(args.push(key),scopeArgs.push("this.scope."+key));return args.push("$element, $root, $parent, $data, window, document, $"),scopeArgs.push("this.$element, this.root, this.parent, this.scope"),smartFunction="( function ( "+args.join(",")+" ) {\n  return "+jsBinding+"\n} ).call( {}, "+scopeArgs.join(", ")+" )",this.cachedBindings[binding]=smartFunction,eval(smartFunction)},Base.prototype.parseString=function(str){var args,jsString,key,scopeArgs,smartFunction,_ref;if(null==(_ref=this.cachedStrings)&&(this.cachedStrings={}),jsString=this.cachedStrings[str])return eval(jsString);str=str.replace(/\"/g,'\\"'),str='"'+str+'"',jsString=CoffeeScript.compile("do -> "+str,{bare:!0}),args=[],scopeArgs=[];for(key in this.scope)isNaN(key)&&(args.push(key),scopeArgs.push("this.scope."+key));return args.push("$element, $root, $parent, $data, window, document, $"),scopeArgs.push("this.$element, this.root, this.parent, this.scope"),smartFunction="( function ( "+args.join(",")+" ) {\n  return "+jsString+"\n} ).call( {}, "+scopeArgs.join(", ")+" )",this.cachedStrings[str]=smartFunction,eval(smartFunction)},Base.prototype.updateBinding=function(t,e){var n,i,r;return null==e&&(e=this.binding),i=e.split("."),n=i.pop(),r=this.parseBinding(i.join("."))||this.scope,("function"==typeof r[n]?r[n](t):void 0)||(r[n]=t)},Base.prototype.insertPlaceholder=function(){var t,e;return e=function(){var e,n,i,r;for(i=this.$element.get(0).attributes,r=[],e=0,n=i.length;n>e;e++)t=i[e],r.push(""+t.nodeName+"='"+t.value+"'");return r}.call(this).join(" "),this.$placeholder=$("<!-- Start BoringJS Block: "+e+" -->").insertBefore(this.$element),$("<!-- End BoringJS Block: "+e+" -->").insertAfter(this.$element)},Base.prototype.wrap=function(){return this.unwrapped?(this.unwrapped=!1,this.$contents.eq(0).before(this.$element),this.$element.append(this.$contents)):void 0},Base.prototype.unwrap=function(){return this.unwrapped||(this.unwrapped=!0),this.$contents=this.$element.contents().insertAfter(this.$element),this.$element.detach()},Base}()})}).call(this);